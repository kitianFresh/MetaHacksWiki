<!DOCTYPE HTML>
<html>
  <head>
    <link rel="Stylesheet" type="text/css" href="/static/css/style.css">
    <link rel="Stylesheet" type="text/css" href="/static/css/tango.css">
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="alternate" type="application/atom+xml" href="atom.xml" title="Atom feed">
    <title>pythonic - MetaHacks Wiki</title>
    <meta name="keywords" content="wiki, simiki, computer, cognitive,"/>
    <meta name="description" content="my personal wiki"/>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  </head>

  <body>
    <div id="container">
      
<div id="header">
  <div class="post-nav"><a href="/">Home</a>&nbsp;&#187;&nbsp;<a href="/#python">python</a>&nbsp;&#187;&nbsp;pythonic
    <span class="updated">Updated&nbsp;
      2017-04-23 22:19
    </span></div>
</div>
<div class="clearfix"></div>

<div class="page_title">pythonic</div>

  <h1 id="python-staticmethod-classmethod">Python @staticmethod 和 @classmethod</h1>
<div class="hlcode"><pre><span class="k">class</span> <span class="nc">Person</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">age</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">age</span> <span class="o">=</span> <span class="n">age</span>

    <span class="k">def</span> <span class="nf">get_age</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">age</span>
</pre></div>


<div class="hlcode"><pre><span class="n">Person</span><span class="o">.</span><span class="n">get_age</span>
</pre></div>


<div class="hlcode"><pre><span class="o">&lt;</span><span class="n">unbound</span> <span class="n">method</span> <span class="n">Person</span><span class="p">.</span><span class="n">get_age</span><span class="o">&gt;</span>
</pre></div>


<p>显示的是未绑定的方法, 为什么? 因为 Python 对象方法需要绑定到某一个实例才可以使用</p>
<div class="hlcode"><pre><span class="n">Person</span><span class="o">.</span><span class="n">get_age</span><span class="p">()</span>
</pre></div>


<div class="hlcode"><pre><span class="o">---------------------------------------------------------------------------</span>

<span class="nx">TypeError</span>                                 <span class="nx">Traceback</span> <span class="p">(</span><span class="nx">most</span> <span class="nx">recent</span> <span class="nb">call</span> <span class="nb">last</span><span class="p">)</span>

<span class="o">&lt;</span><span class="nx">ipython</span><span class="na">-input</span><span class="o">-</span><span class="mi">46</span><span class="o">-</span><span class="mi">2</span><span class="nx">e11244cec48</span><span class="o">&gt;</span> <span class="k">in</span> <span class="o">&lt;</span><span class="nx">module</span><span class="o">&gt;</span><span class="p">()</span>
<span class="o">----&gt;</span> <span class="mi">1</span> <span class="nx">Person.get_age</span><span class="p">()</span>


<span class="nx">TypeError</span><span class="p">:</span> <span class="nx">unbound</span> <span class="nb">method</span> <span class="nx">get_age</span><span class="p">()</span> <span class="nx">must</span> <span class="nx">be</span> <span class="nx">called</span> <span class="k">with</span> <span class="nx">Person</span> <span class="nx">instance</span> <span class="nx">as</span> <span class="nb">first</span> <span class="nx">argument</span> <span class="p">(</span><span class="nx">got</span> <span class="nx">nothing</span> <span class="nx">instead</span><span class="p">)</span>
</pre></div>


<div class="hlcode"><pre><span class="n">Person</span><span class="o">.</span><span class="n">get_age</span><span class="p">(</span><span class="n">Person</span><span class="p">(</span><span class="mi">23</span><span class="p">))</span>
</pre></div>


<div class="hlcode"><pre><span class="mi">23</span>
</pre></div>


<p>这里其实就相当于 <code>Person(23)</code>　这个对象和我们的　<code>Person.get_age</code>　方法绑定了．这也是为什么实例方法都需要 <code>self</code> 做参数的原因了；</p>
<p>但是，　如果我们不记得类名字了，　就无法这样调用方法了．　因此　Python 提供了　Syntax Sugar, 直接通过和　Java 一样的方式调用绑定的实例方法即可！</p>
<div class="hlcode"><pre><span class="n">Person</span><span class="p">(</span><span class="mi">23</span><span class="p">)</span><span class="o">.</span><span class="n">get_age</span><span class="p">()</span><span class="c"># &lt;==&gt; Person.get_age(Person(23))</span>
</pre></div>


<div class="hlcode"><pre><span class="mi">23</span>
</pre></div>


<div class="hlcode"><pre><span class="n">Person</span><span class="p">(</span><span class="mi">22</span><span class="p">)</span><span class="o">.</span><span class="n">get_age</span>
</pre></div>


<div class="hlcode"><pre><span class="o">&lt;</span><span class="n">bound</span> <span class="n">method</span> <span class="n">Person</span><span class="p">.</span><span class="n">get_age</span> <span class="n">of</span> <span class="o">&lt;</span><span class="n">__main__</span><span class="p">.</span><span class="n">Person</span> <span class="n">object</span> <span class="n">at</span> <span class="mh">0x7f5b24107e10</span><span class="o">&gt;&gt;</span>
</pre></div>


<p>每一个绑定的方法，都可以获取他所绑定到的对象，　使用　方法　的　<code>__self__</code> 属性即可；</p>
<div class="hlcode"><pre><span class="n">m</span> <span class="o">=</span> <span class="n">Person</span><span class="p">(</span><span class="mi">23</span><span class="p">)</span><span class="o">.</span><span class="n">get_age</span>
<span class="n">m</span><span class="o">.</span><span class="n">__self__</span>
</pre></div>


<div class="hlcode"><pre><span class="o">&lt;</span><span class="n">__main__</span><span class="p">.</span><span class="n">Person</span> <span class="n">at</span> <span class="mh">0x7f5b24107d50</span><span class="o">&gt;</span>
</pre></div>


<div class="hlcode"><pre><span class="n">m</span> <span class="o">==</span> <span class="n">m</span><span class="o">.</span><span class="n">__self__</span><span class="o">.</span><span class="n">get_age</span>
</pre></div>


<div class="hlcode"><pre><span class="n">True</span>
</pre></div>


<p>In Python 3, the functions attached to a class are <em>not</em> considered as <em>unbound method</em> anymore, but as simple functions, that are bound to an object if required. So the principle stays the same, the model is just simplified.</p>
<div class="hlcode"><pre><span class="o">&gt;&gt;&gt;</span> <span class="k">class</span> <span class="nc">Pizza</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="o">...</span>     <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="p">):</span>
<span class="o">...</span>         <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">size</span>
<span class="o">...</span>     <span class="k">def</span> <span class="nf">get_size</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="o">...</span>         <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span>
<span class="o">...</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">Pizza</span><span class="o">.</span><span class="n">get_size</span>
<span class="o">&lt;</span><span class="n">function</span> <span class="n">Pizza</span><span class="o">.</span><span class="n">get_size</span> <span class="n">at</span> <span class="mh">0x7f307f984dd0</span><span class="o">&gt;</span>
</pre></div>


<h2 id="static-methods">Static Methods</h2>
<p>对于属于一个类，但是却从不使用该类实例变量的方法来说，　使用静态方法就够了．<strong>他既不和类的实例(self)绑定，也不和类本身(cls)绑定．只是意义上属于类的一个普通方法而已．</strong></p>
<div class="hlcode"><pre><span class="k">class</span> <span class="nc">Pizza</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">mix_ingredients</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span>

    <span class="k">def</span> <span class="nf">cook</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mix_ingredients</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cheese</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vegetables</span><span class="p">)</span>
</pre></div>


<ol>
<li>
<p><strong>Python 会将每一个实例方法和一个实例化对象绑定起来，而且绑定过的实例方法在Python 中也是对象，即使是同一个方法，每一个新对象都要生成一个新的绑定方法对象，非常耗费空间和时间，而使用　staticmethod 不会进行对象绑定；</strong></p>
</li>
<li>
<p><strong>@staticmethod 支持子类重写，即多态．如果你使用一个模块内的顶层函数　mix_ingredients, 继承自　Pizza　的子类并不能改变行为如果你不重写cook方法．</strong></p>
</li>
</ol>
<div class="hlcode"><pre><span class="k">print</span> <span class="n">Pizza</span><span class="p">()</span><span class="o">.</span><span class="n">cook</span> <span class="ow">is</span> <span class="n">Pizza</span><span class="p">()</span><span class="o">.</span><span class="n">cook</span>
<span class="k">print</span> <span class="n">Pizza</span><span class="p">()</span><span class="o">.</span><span class="n">mix_ingredients</span> <span class="ow">is</span> <span class="n">Pizza</span><span class="p">()</span><span class="o">.</span><span class="n">mix_ingredients</span>
<span class="k">print</span> <span class="n">Pizza</span><span class="p">()</span><span class="o">.</span><span class="n">mix_ingredients</span> <span class="ow">is</span> <span class="n">Pizza</span><span class="o">.</span><span class="n">mix_ingredients</span>
</pre></div>


<div class="hlcode"><pre><span class="n">False</span>
<span class="n">True</span>
<span class="n">True</span>
</pre></div>


<h2 id="class-methods">Class Methods</h2>
<p><strong>并不和对象绑定，但是和类绑定的方法, 需要加上　<code>cls</code> 参数</strong></p>
<div class="hlcode"><pre><span class="k">class</span> <span class="nc">Pizza</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="n">radius</span> <span class="o">=</span> <span class="mi">23</span>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">get_radius</span><span class="p">(</span><span class="n">cls</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">cls</span><span class="o">.</span><span class="n">radius</span>
</pre></div>


<div class="hlcode"><pre><span class="n">Pizza</span><span class="o">.</span><span class="n">get_radius</span>
</pre></div>


<div class="hlcode"><pre><span class="o">&lt;</span><span class="n">bound</span> <span class="n">method</span> <span class="n">type</span><span class="p">.</span><span class="n">get_radius</span> <span class="n">of</span> <span class="o">&lt;</span><span class="n">class</span> <span class="err">&#39;</span><span class="n">__main__</span><span class="p">.</span><span class="n">Pizza</span><span class="err">&#39;</span><span class="o">&gt;&gt;</span>
</pre></div>


<div class="hlcode"><pre><span class="n">Pizza</span><span class="p">()</span><span class="o">.</span><span class="n">get_radius</span>
</pre></div>


<div class="hlcode"><pre><span class="o">&lt;</span><span class="n">bound</span> <span class="n">method</span> <span class="n">type</span><span class="p">.</span><span class="n">get_radius</span> <span class="n">of</span> <span class="o">&lt;</span><span class="n">class</span> <span class="err">&#39;</span><span class="n">__main__</span><span class="p">.</span><span class="n">Pizza</span><span class="err">&#39;</span><span class="o">&gt;&gt;</span>
</pre></div>


<div class="hlcode"><pre><span class="n">Pizza</span><span class="o">.</span><span class="n">get_radius</span><span class="o">.</span><span class="n">__self__</span> <span class="ow">is</span> <span class="n">Pizza</span><span class="p">()</span><span class="o">.</span><span class="n">get_radius</span><span class="o">.</span><span class="n">__self__</span>
</pre></div>


<div class="hlcode"><pre><span class="n">True</span>
</pre></div>


<div class="hlcode"><pre><span class="n">Pizza</span><span class="o">.</span><span class="n">get_radius</span> <span class="o">==</span> <span class="n">Pizza</span><span class="p">()</span><span class="o">.</span><span class="n">get_radius</span>
</pre></div>


<div class="hlcode"><pre><span class="n">True</span>
</pre></div>


<div class="hlcode"><pre><span class="n">Pizza</span><span class="o">.</span><span class="n">get_radius</span><span class="p">()</span>
</pre></div>


<div class="hlcode"><pre><span class="mi">23</span>
</pre></div>


<p>classmethod 的用法</p>
<ol>
<li><strong>FactoryMethods. 如果我们需要使用一些预处理来创建实例，　使用 @staticmethod 必须硬编码类名　Pizza 在我们的函数中，　这样任何集成　Pizza 的子类就不能够使用工厂方法为自己所用了．</strong></li>
</ol>
<div class="hlcode"><pre><span class="n">class</span> <span class="n">Pizza</span><span class="p">(</span><span class="n">object</span><span class="p">)</span><span class="o">:</span>
    <span class="n">def</span> <span class="n">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">ingredients</span><span class="p">)</span><span class="o">:</span>
        <span class="n">self</span><span class="p">.</span><span class="n">ingredients</span> <span class="o">=</span> <span class="n">ingredients</span>

    <span class="err">@</span><span class="n">classmethod</span>
    <span class="n">def</span> <span class="n">from_fridge</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">fridge</span><span class="p">)</span><span class="o">:</span>
        <span class="k">return</span> <span class="n">cls</span><span class="p">(</span><span class="n">fridge</span><span class="p">.</span><span class="n">get_cheese</span><span class="p">()</span> <span class="o">+</span> <span class="n">fridge</span><span class="p">.</span><span class="n">get_vegetables</span><span class="p">())</span>
</pre></div>


<ol>
<li><strong>需要调用静态方法的静态方法直接使用　classmethod. 原因还是因为在静态方法中又必须硬编码类名，　子类就无法；</strong></li>
</ol>
<div class="hlcode"><pre><span class="k">class</span> <span class="nc">Pizza</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">height</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">radius</span> <span class="o">=</span> <span class="n">radius</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="n">height</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">compute_area</span><span class="p">(</span><span class="n">radius</span><span class="p">):</span>
         <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="p">(</span><span class="n">radius</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">compute_volume</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">radius</span><span class="p">):</span>
         <span class="k">return</span> <span class="n">height</span> <span class="o">*</span> <span class="n">cls</span><span class="o">.</span><span class="n">compute_area</span><span class="p">(</span><span class="n">radius</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_volume</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_volume</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">height</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">radius</span><span class="p">)</span>
</pre></div>


<h2 id="abstract-methods">Abstract Methods</h2>
<p>定义在基类中还未被实现的方法．</p>
<div class="hlcode"><pre><span class="k">class</span> <span class="nc">Pizza</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">get_radius</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</pre></div>


<p>任何继承自　Pizza 的子类都必须覆盖　get_radius 方法，　否则就会在调用的时候抛出　异常．</p>
<div class="hlcode"><pre><span class="o">&gt;&gt;&gt;</span> <span class="n">Pizza</span><span class="p">()</span>
<span class="o">&lt;</span><span class="n">__main__</span><span class="o">.</span><span class="n">Pizza</span> <span class="nb">object</span> <span class="n">at</span> <span class="mh">0x7fb747353d90</span><span class="o">&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">Pizza</span><span class="p">()</span><span class="o">.</span><span class="n">get_radius</span><span class="p">()</span>
<span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
  <span class="n">File</span> <span class="s">&quot;&lt;stdin&gt;&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">1</span><span class="p">,</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
  <span class="n">File</span> <span class="s">&quot;&lt;stdin&gt;&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">3</span><span class="p">,</span> <span class="ow">in</span> <span class="n">get_radius</span>
<span class="ne">NotImplementedError</span>
</pre></div>


<p>但是以上实现方式会使得异常在调用该方法的时候才会发生，　要想提前知道方法未实现，　可以使用　<code>abc</code>　模块．</p>
<div class="hlcode"><pre><span class="kn">import</span> <span class="nn">abc</span>

<span class="k">class</span> <span class="nc">BasePizza</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="n">__metaclass__</span>  <span class="o">=</span> <span class="n">abc</span><span class="o">.</span><span class="n">ABCMeta</span>

    <span class="nd">@abc.abstractmethod</span>
    <span class="k">def</span> <span class="nf">get_radius</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
         <span class="sd">&quot;&quot;&quot;Method that should do something.&quot;&quot;&quot;</span>
</pre></div>


<div class="hlcode"><pre><span class="k">class</span> <span class="nc">Methods</span><span class="p">:</span>
  <span class="k">def</span> <span class="nf">i_method</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">x</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">s_method</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">c_method</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span><span class="n">x</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>

  <span class="n">s_method</span> <span class="o">=</span> <span class="nb">staticmethod</span><span class="p">(</span><span class="n">s_method</span><span class="p">)</span>
  <span class="n">c_method</span> <span class="o">=</span> <span class="nb">classmethod</span><span class="p">(</span><span class="n">c_method</span><span class="p">)</span>

<span class="n">obj</span> <span class="o">=</span> <span class="n">Methods</span><span class="p">()</span>

<span class="n">obj</span><span class="o">.</span><span class="n">i_method</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">Methods</span><span class="o">.</span><span class="n">i_method</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<span class="n">obj</span><span class="o">.</span><span class="n">s_method</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">Methods</span><span class="o">.</span><span class="n">s_method</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>

<span class="n">obj</span><span class="o">.</span><span class="n">c_method</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="n">Methods</span><span class="o">.</span><span class="n">c_method</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
</pre></div>


<div class="hlcode"><pre><span class="p">(</span><span class="o">&lt;</span><span class="n">__main__</span><span class="p">.</span><span class="n">Methods</span> <span class="n">instance</span> <span class="n">at</span> <span class="mh">0x7f5b240c8e60</span><span class="o">&gt;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="p">(</span><span class="o">&lt;</span><span class="n">__main__</span><span class="p">.</span><span class="n">Methods</span> <span class="n">instance</span> <span class="n">at</span> <span class="mh">0x7f5b240c8e60</span><span class="o">&gt;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="mi">3</span>
<span class="mi">4</span>
<span class="p">(</span><span class="o">&lt;</span><span class="n">class</span> <span class="n">__main__</span><span class="p">.</span><span class="n">Methods</span> <span class="n">at</span> <span class="mh">0x7f5b24067db8</span><span class="o">&gt;</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="p">(</span><span class="o">&lt;</span><span class="n">class</span> <span class="n">__main__</span><span class="p">.</span><span class="n">Methods</span> <span class="n">at</span> <span class="mh">0x7f5b24067db8</span><span class="o">&gt;</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
</pre></div>


<p>以上实现和一下实现等价：</p>
<div class="hlcode"><pre><span class="k">class</span> <span class="nc">Methods</span><span class="p">:</span>
  <span class="k">def</span> <span class="nf">i_method</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">x</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>

  <span class="nd">@staticmethod</span>
  <span class="k">def</span> <span class="nf">s_method</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

  <span class="nd">@classmethod</span>
  <span class="k">def</span> <span class="nf">c_method</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span><span class="n">x</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>

<span class="n">obj</span> <span class="o">=</span> <span class="n">Methods</span><span class="p">()</span>

<span class="n">obj</span><span class="o">.</span><span class="n">i_method</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">Methods</span><span class="o">.</span><span class="n">i_method</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<span class="n">obj</span><span class="o">.</span><span class="n">s_method</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">Methods</span><span class="o">.</span><span class="n">s_method</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>

<span class="n">obj</span><span class="o">.</span><span class="n">c_method</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="n">Methods</span><span class="o">.</span><span class="n">c_method</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
</pre></div>


<div class="hlcode"><pre><span class="p">(</span><span class="o">&lt;</span><span class="n">__main__</span><span class="p">.</span><span class="n">Methods</span> <span class="n">instance</span> <span class="n">at</span> <span class="mh">0x7f5b24039200</span><span class="o">&gt;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="p">(</span><span class="o">&lt;</span><span class="n">__main__</span><span class="p">.</span><span class="n">Methods</span> <span class="n">instance</span> <span class="n">at</span> <span class="mh">0x7f5b24039200</span><span class="o">&gt;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="mi">3</span>
<span class="mi">4</span>
<span class="p">(</span><span class="o">&lt;</span><span class="n">class</span> <span class="n">__main__</span><span class="p">.</span><span class="n">Methods</span> <span class="n">at</span> <span class="mh">0x7f5b24067e88</span><span class="o">&gt;</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="p">(</span><span class="o">&lt;</span><span class="n">class</span> <span class="n">__main__</span><span class="p">.</span><span class="n">Methods</span> <span class="n">at</span> <span class="mh">0x7f5b24067e88</span><span class="o">&gt;</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
</pre></div>


<div class="hlcode"><pre><span class="k">class</span> <span class="nc">S</span><span class="p">:</span>
   <span class="n">nInstances</span> <span class="o">=</span> <span class="mi">0</span>
   <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="n">S</span><span class="o">.</span><span class="n">nInstances</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">nInstances</span> <span class="o">+</span> <span class="mi">1</span>

   <span class="nd">@staticmethod</span>
   <span class="k">def</span> <span class="nf">howManyInstances</span><span class="p">():</span>
      <span class="k">print</span><span class="p">(</span><span class="s">&#39;Number of instances created: &#39;</span><span class="p">,</span> <span class="n">S</span><span class="o">.</span><span class="n">nInstances</span><span class="p">)</span>

<span class="n">a</span> <span class="o">=</span> <span class="n">S</span><span class="p">()</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">S</span><span class="p">()</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">S</span><span class="p">()</span>
<span class="n">S</span><span class="o">.</span><span class="n">howManyInstances</span><span class="p">()</span>
</pre></div>


<div class="hlcode"><pre><span class="p">(</span><span class="err">&#39;</span><span class="n">Number</span> <span class="n">of</span> <span class="n">instances</span> <span class="n">created</span><span class="o">:</span> <span class="err">&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>


<h2 id="_1">参考</h2>
<p>- <a href="https://julien.danjou.info/blog/2013/guide-python-static-class-abstract-methods">guide-python-static-class-abstract-methods</a></p>
<h1 id="python-dictkey">python dict按照key 排序：</h1>
<p>1、method 1.</p>
<div class="hlcode"><pre><span class="n">items</span> <span class="o">=</span> <span class="nb">dict</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
<span class="n">items</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
<span class="k">for</span> <span class="n">key</span><span class="p">,</span><span class="n">value</span> <span class="ow">in</span> <span class="n">items</span><span class="p">:</span>
   <span class="k">print</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="c"># print key,dict[key]</span>
</pre></div>


<p>2、method 2.</p>
<div class="hlcode"><pre><span class="k">print</span> <span class="n">key</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</pre></div>


<h1 id="python-dictvalue">python dict按照value排序：</h1>
<p>method 1：</p>
<p>把dictionary中的元素分离出来放到一个list中，对list排序，从而间接实现对dictionary的排序。这个“元素”可以是key，value或者item。</p>
<p>method2：</p>
<h1 id="lambda">用lambda表达式来排序，更灵活：</h1>
<div class="hlcode"><pre><span class="c"># sorted(iterable, cmp=None, key=None, reverse=False) --&gt; new sorted list</span>

<span class="nb">sorted</span><span class="p">(</span><span class="nb">dict</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">cmp</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
<span class="c">#降序</span>
<span class="nb">sorted</span><span class="p">(</span><span class="nb">dict</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">cmp</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">reverse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="k">print</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">dict1</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">d</span><span class="p">:</span> <span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="k">print</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">dict1</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">d</span><span class="p">:</span> <span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>


<h1 id="python-shell">Python 调用 shell 命令行程序</h1>
<h2 id="python">Python实现的文件编码转码工具</h2>
<div class="hlcode"><pre><span class="c">#!/usr/bin/python</span>
<span class="c"># -*- coding: utf-8 -*-</span>

<span class="kn">import</span> <span class="nn">glob</span>  
<span class="kn">import</span> <span class="nn">subprocess</span>

<span class="c">#父目录中的.py文件  </span>
<span class="n">files</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">iglob</span><span class="p">(</span><span class="s">r&#39;./*.csv&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
    <span class="n">subprocess</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="s">&quot;enca -L zh_CN &quot;</span> <span class="o">+</span> <span class="n">f</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
    <span class="n">subprocess</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="s">&quot;enca -L zh_CN -x utf-8 &quot;</span> <span class="o">+</span> <span class="n">f</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>


<h2 id="python_1">Python 实现解释器命令行中自动补全</h2>
<p>第一种方法是直接每次先执行以下语句:</p>
<div class="hlcode"><pre><span class="kn">import</span> <span class="nn">readline</span><span class="o">,</span> <span class="nn">rlcompleter</span><span class="p">;</span> <span class="n">readline</span><span class="o">.</span><span class="n">parse_and_bind</span><span class="p">(</span><span class="s">&quot;tab: complete&quot;</span><span class="p">)</span>
</pre></div>


<p>方法二新建一个 <code>.pythonstartup.py</code> 的脚本, 然后在 <code>.bashrc</code> 中加入 <code>export PYTHONSTARTUP = ~/.pythonstartup.py</code> </p>
<div class="hlcode"><pre><span class="c">#.pythonstartup.py</span>
<span class="kn">import</span> <span class="nn">readline</span><span class="o">,</span> <span class="nn">rlcompleter</span> 
<span class="n">readline</span><span class="o">.</span><span class="n">parse_and_bind</span><span class="p">(</span><span class="s">&quot;tab: complete&quot;</span><span class="p">)</span>
</pre></div>


<p>最后执行 <code>source .bashrc</code> 生效. 然后在解释器中使用 <code>tab</code> 就会是自动补全了, 不再是一个缩进!缩进只能使用四个空格;</p>
    </div>
    <div id="footer">
      <span>
        <p>Copyright © 2017 田奇.
        Powered by <a href="http://simiki.org/" target="_blank">Simiki</a>.</p>
        <p>Site Generated 2017-06-05 22:21:46</p>
      </span>
    </div>
  </body>
</html>