<!DOCTYPE HTML>
<html>
  <head>
    <link rel="Stylesheet" type="text/css" href="/static/css/style.css">
    <link rel="Stylesheet" type="text/css" href="/static/css/tango.css">
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="alternate" type="application/atom+xml" href="atom.xml" title="Atom feed">
    <title>python-string - MetaHacks Wiki</title>
    <meta name="keywords" content="wiki, simiki, computer, cognitive,"/>
    <meta name="description" content="my personal wiki"/>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  </head>

  <body>
    <div id="container">
      
<div id="header">
  <div class="post-nav"><a href="/">Home</a>&nbsp;&#187;&nbsp;<a href="/#python">python</a>&nbsp;&#187;&nbsp;python-string
    <span class="updated">Updated&nbsp;
      2017-04-30 11:22
    </span></div>
</div>
<div class="clearfix"></div>

<div class="page_title">python-string</div>

  <h2 id="_1">格式字符串手册</h2>
<p>数字格式化</p>
<p>下面的表格展示了使用Python的后起新秀str.format()格式化数字的多种方法，包含浮点数格式化与整数格式化示例。可使用 print("FORMAT".format(NUMBER)); 来运行示例，因此你可以运行： print("{:.2f}".format(3.1415926)); 来得到第一个示例的输出。</p>
<div class="hlcode"><pre><span></span>    数字  格式  输出  描述
    3.1415926   {:.2f}  3.14    保留小数点后两位
    3.1415926   {:+.2f} +3.14   带符号保留小数点后两位
    -1  {:+.2f} -1.00   带符号保留小数点后两位
    2.71828 {:.0f}  3   不带小数
    5   {:0&gt;2d} 05  数字补零 (填充左边, 宽度为2)
    5   {:x&lt;4d} 5xxx    数字补x (填充右边, 宽度为4)
    10  {:x&lt;4d} 10xx    数字补x (填充右边, 宽度为4)
    1000000 {:,}    1,000,000   以逗号分隔的数字格式
    0.25    {:.2%}  25.00%  百分比格式
    1000000000  {:.2e}  1.00e+09    指数记法
    13  {:10d}          13  右对齐 (默认, 宽度为10)
    13  {:&lt;10d} 13  左对齐 (宽度为10)
    13  {:^10d}     13  中间对齐 (宽度为10)
</pre></div>


<h2 id="pythonapplication">Python获取application运行的路径</h2>
<div class="hlcode"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>

<span class="k">def</span> <span class="nf">is_packaged</span><span class="p">():</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">sys</span><span class="p">,</span> <span class="s1">&#39;frozen&#39;</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">sys</span><span class="o">.</span><span class="n">frozen</span>

    <span class="k">return</span> <span class="bp">False</span>


<span class="k">def</span> <span class="nf">get_root</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">sys</span><span class="o">.</span><span class="n">_MEIPASS</span>
</pre></div>


<div class="hlcode"><pre><span></span><span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">pyinstaller</span>


<span class="k">def</span> <span class="nf">get_mclouds_root</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">pyinstaller</span><span class="o">.</span><span class="n">is_packaged</span><span class="p">():</span>
        <span class="k">return</span> <span class="n">pyinstaller</span><span class="o">.</span><span class="n">get_root</span><span class="p">()</span>

    <span class="n">cur_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span>
    <span class="n">cur_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">cur_path</span><span class="p">)</span>
    <span class="k">assert</span><span class="p">(</span><span class="n">cur_path</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;clouds/common&#39;</span><span class="p">))</span>
    <span class="n">pos</span> <span class="o">=</span> <span class="n">cur_path</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="s1">&#39;meituan/server&#39;</span><span class="p">)</span>
    <span class="k">assert</span><span class="p">(</span><span class="n">pos</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">cur_path</span><span class="p">[:</span><span class="n">pos</span><span class="p">]</span>


<span class="k">def</span> <span class="nf">get_mclouds_scripts_path</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">get_mclouds_root</span><span class="p">(),</span> <span class="s1">&#39;meituan/scripts&#39;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">get_mclouds_workspace_path</span><span class="p">():</span>
    <span class="n">root_path</span> <span class="o">=</span> <span class="n">get_mclouds_root</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">pyinstaller</span><span class="o">.</span><span class="n">is_packaged</span><span class="p">():</span>
        <span class="n">root_path</span> <span class="o">=</span> <span class="s1">&#39;/opt/cloud/&#39;</span>

    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">root_path</span><span class="p">,</span> <span class="s1">&#39;workspace&#39;</span><span class="p">)</span>
</pre></div>


<h2 id="chroot">chroot机制可以更改当前程序运行的参考根目录</h2>
<p>chroot 可以实现安全隔离，从新制造一个新的根目录，并且程序只对该目新的根目录具有权限，其他目录对该进程就不可见了。从而实现安全隔离，但是如果程序还想要访问其他的库，命令，需要组织根目录，把相应的库文件放到相应的目录下面，可以用 busybox实现这个功能。就是有制造出一个linux系统资源目录出来给某个进程使用，类似容器隔离技术。</p>
<div class="hlcode"><pre><span></span><span class="kn">import</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">sys</span>
<span class="n">newroot</span> <span class="o">=</span> <span class="s1">&#39;/Users/kiki/tmp&#39;</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">newroot</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">newroot</span><span class="p">)</span>
<span class="n">os</span><span class="o">.</span><span class="n">chroot</span><span class="p">(</span><span class="n">newroot</span><span class="p">)</span>
<span class="k">print</span> <span class="vm">__file__</span>
<span class="k">print</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
<span class="k">print</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span>
</pre></div>


<h2 id="argparse-metavar-actionstore_true">argparse 中 <code>metavar</code> 不能和<code>action=store_true</code> 同时用。</h2>
    </div>
    <div id="footer">
      <span>
        <p>Copyright © 2017 田奇.
        Powered by <a href="http://simiki.org/" target="_blank">Simiki</a>.</p>
        <p>Site Generated 2017-12-05 23:08:39</p>
      </span>
    </div>
  </body>
</html>